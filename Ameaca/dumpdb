CREATE TABLE ttype (
    id                      INTEGER         PRIMARY KEY AUTOINCREMENT,
    name                    TEXT (100)      UNIQUE NOT NULL
);
CREATE TABLE tcriticallylevel (
    id                      INTEGER         PRIMARY KEY AUTOINCREMENT,
    name                    VARCHAR (10)    UNIQUE NOT NULL
);
CREATE TABLE threat (
    id                      INTEGER         PRIMARY KEY AUTOINCREMENT NOT NULL,
    cve                     VARCHAR (14)    NOT NULL,
    discovery_date          DATETIME        NOT NULL,
    critically_level_id     INTEGER         NOT NULL REFERENCES tcriticallylevel (id),
    type_id                 INTEGER         NOT NULL REFERENCES ttype (id)
);
CREATE TABLE pversion (
    id   INTEGER                PRIMARY KEY AUTOINCREMENT,
    name VARCHAR (20)           NOT NULL UNIQUE
);
CREATE TABLE product (
    id         INTEGER          PRIMARY KEY AUTOINCREMENT,
    name       VARCHAR (150)    UNIQUE NOT NULL
);
CREATE TABLE version_product (
    id          INTEGER          PRIMARY KEY AUTOINCREMENT,
    product_id  INTEGER          REFERENCES product (id) NOT NULL,
    version_id  INTEGER          REFERENCES pversion (id) NOT NULL
);
CREATE TABLE threat_product (
    id         INTEGER          PRIMARY KEY AUTOINCREMENT,
    product_id INTEGER          REFERENCES product (id) NOT NULL,
    threat_id  INTEGER          REFERENCES threat (id) NOT NULL
);
INSERT INTO tcriticallylevel (name) values ('LOW');
INSERT INTO tcriticallylevel (name) values ('MEDIUM');
INSERT INTO tcriticallylevel (name) values ('HIGH');
INSERT INTO ttype (name) values ('Spam');
INSERT INTO ttype (name) values ('Worm');
INSERT INTO ttype (name) values ('Virus');
INSERT INTO ttype (name) values ('DDOS');
INSERT INTO ttype (name) values ('Ramsoware');

EXIT
    -- consequence BLOB            NOT NULL,
    -- solution    BLOB            NOT NULL,