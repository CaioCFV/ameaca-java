CREATE TABLE threat (
    id  INTEGER                 PRIMARY KEY AUTOINCREMENT
                                NOT NULL,
    cve VARCHAR (200)           NOT NULL
);
CREATE TABLE version (
    id   INTEGER                PRIMARY KEY AUTOINCREMENT,
    name VARCHAR (20)           NOT NULL UNIQUE
);
CREATE TABLE product (
    id         INTEGER          PRIMARY KEY AUTOINCREMENT,
    name       VARCHAR (150)    UNIQUE NOT NULL,
    version_id INTEGER          REFERENCES version (id) NOT NULL
);
CREATE TABLE threat_product (
    id         INTEGER          PRIMARY KEY AUTOINCREMENT,
    product_id INTEGER          REFERENCES product (id) NOT NULL,
    threat_id  INTEGER REFERENCES threat (id) NOT NULL
);
EXIT